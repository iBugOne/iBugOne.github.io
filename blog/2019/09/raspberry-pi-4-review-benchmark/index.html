<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.22.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
	<head>
		<meta charset="utf-8">
		<!-- begin _includes/seo.html -->
		<title>Raspberry Pi 4 B Review and Benchmark - What’s improved over Pi 3 B+ - iBug</title>
		<meta name="description" content="Lately I’ve finally received my Raspberry Pi 4 (4 GB model), and I couldn’t resist the temptation to give it a try and see all the improvements that’s been reported for months.">
		<meta name="author" content="iBug">
		<meta property="article:author" content="iBug">
		<meta property="og:type" content="article">
		<meta property="og:locale" content="en_US">
		<meta property="og:site_name" content="iBug">
		<meta property="og:title" content="Raspberry Pi 4 B Review and Benchmark - What’s improved over Pi 3 B+">
		<meta property="og:url" content="https://ibug.io/blog/2019/09/raspberry-pi-4-review-benchmark/">
		<meta property="og:description" content="Lately I’ve finally received my Raspberry Pi 4 (4 GB model), and I couldn’t resist the temptation to give it a try and see all the improvements that’s been reported for months.">
		<meta property="og:image" content="https://ibug.io/image/og.jpg">
		<meta property="article:published_time" content="2019-09-10T00:00:00+00:00">
		<meta property="article:modified_time" content="2021-02-04T21:47:35+00:00">
		<link rel="canonical" href="https://ibug.io/blog/2019/09/raspberry-pi-4-review-benchmark/">
		<script type="application/ld+json">
			{
			  "@context": "https://schema.org",
			
			    "@type": "Person",
			    "name": "iBug",
			    "url": "https://ibug.io/"
			
			}
		</script>
		<meta name="google-site-verification" content="5_jn7a-vZslUtLJO-BkY-cPDGgah5JP49RGgeOBmYSk" />
		<!-- end _includes/seo.html -->
		<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="iBug Feed">
		<!-- https://t.co/dKP3o1e -->
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<script>
			document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
		</script>
		<!-- For all browsers -->
		<link rel="stylesheet" href="/assets/css/main.css?v=4349676">
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/iBug-web/static/fontawesome/5/css/all.min.css">
		<!--[if IE]>
			<style>
				/* old IE unsupported flexbox fixes */
				.greedy-nav .site-title {
				  padding-right: 3em;
				}
				.greedy-nav button {
				  position: absolute;
				  top: 0;
				  right: 0;
				  height: 100%;
				}
			</style>
		<![endif]-->
		<link rel="shortcut icon" type="image/png" href="/assets/favicon.png">
		<meta name="theme-color" content="#EDEDED">
		<script>
			const funcOnPageLoad = function() { document.body.classList.add("loaded"); };
			document.addEventListener('DOMContentLoaded', funcOnPageLoad);
		</script>
		<!--
 Minimal Mistakes layout: single
 Page Path: _posts/2019/2019-09-10-raspberry-pi-4-review-benchmark.md
 Page Type: 
-->
	</head>
	<body class="layout--single">
		<nav class="skip-links">
			<h2 class="screen-reader-text">Skip links</h2>
			<ul>
				<li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
				<li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
				<li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
			</ul>
		</nav>
		<!--[if lt IE 9]>
			<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
		<![endif]-->
		<div class="masthead">
			<div class="masthead__inner-wrap">
				<div class="masthead__menu">
					<nav id="site-nav" class="greedy-nav">
						<a class="site-logo" href="/"><img src="/assets/favicon.png" alt=""></a>
						<a class="site-title" href="/">
							iBug
						</a>
						<ul class="visible-links">
							<li class="masthead__menu-item">
								<a href="/about/">About</a>
							</li>
							<li class="masthead__menu-item">
								<a href="/blog/">Blog</a>
							</li>
							<li class="masthead__menu-item">
								<a href="/projects/">Projects</a>
							</li>
							<li class="masthead__menu-item">
								<a href="/friends/">Friends</a>
							</li>
							<li class="masthead__menu-item">
								<a href="/cn/">中文内容</a>
							</li>
						</ul>
						<button class="search__toggle" type="button">
							<span class="visually-hidden">Toggle search</span>
							<svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
								<path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
							</svg>
						</button>
						<button class="greedy-nav__toggle hidden" type="button">
							<span class="visually-hidden">Toggle menu</span>
							<div class="navicon"></div>
						</button>
						<ul class="hidden-links hidden"></ul>
					</nav>
				</div>
			</div>
		</div>
		<div class="initial-content">
			<div class="page__hero--overlay"
  style=" background-image: url('/image/header/mountain-1.jpg');"
>
				<div class="wrapper">
					<h1 id="page-title" class="page__title" itemprop="headline">
						Raspberry Pi 4 B Review and Benchmark - What’s improved over Pi 3 B+
					</h1>
					<p class="page__meta">
						<span class="page__meta-date">
							<i class="far fa-calendar-alt" aria-hidden="true"></i>
							<time datetime="2019-09-10T00:00:00+00:00">September 10, 2019</time>
						</span>
						<span class="page__meta-sep"></span>
						<span class="page__meta-readtime">
							<i class="far fa-clock" aria-hidden="true"></i>
							9 minute read
						</span>
					</p>
				</div>
			</div>
			<div id="main" role="main">
				<div class="sidebar sticky">
					<div itemscope itemtype="https://schema.org/Person">
						<div class="author__avatar">
							<img src="/image/avatar.png" alt="iBug" itemprop="image">
						</div>
						<div class="author__content">
							<h3 class="author__name" itemprop="name">iBug</h3>
							<div class="author__bio" itemprop="description">
								<p>Developer, System Administrator, Geek</p>
							</div>
						</div>
						<div class="author__urls-wrapper">
							<button class="btn btn--inverse">Follow</button>
							<ul class="author__urls social-icons">
								<li><a href="mailto:%69@ibugone.com" rel="nofollow noopener noreferrer"><i class="far fa-fw fa-envelope" aria-hidden="true"></i><span class="label">Email</span></a></li>
								<li><a href="https://stackoverflow.com/users/5958455/ibug" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-stack-overflow" aria-hidden="true"></i><span class="label">Stack Overflow</span></a></li>
								<li><a href="https://github.com/iBug" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
								<li><a href="https://steamcommunity.com/id/ibugone" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-steam" aria-hidden="true"></i><span class="label">Steam</span></a></li>
								<li><a href="https://t.me/ibugthought" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-telegram-plane" aria-hidden="true"></i><span class="label">Telegram Channel</span></a></li>
								<!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
							</ul>
						</div>
					</div>
					<nav class="nav__list">
						<input id="ac-toc" name="accordion-toc" type="checkbox" />
						<label for="ac-toc">Toggle menu</label>
						<ul class="nav__items">
							<li>
								<span class="nav__sub-title">iBug on the Web</span>
								<ul>
									<li><a href="/"><i class="fas fa-fw fa-home"></i> Home</a></li>
									<li><a href="/about/"><i class="fas fa-fw fa-grin-alt"></i> About iBug</a></li>
									<li><a href="/blog/"><i class="fas fa-fw fa-book"></i> Blog</a></li>
									<li><a href="/skills/"><i class="fas fa-fw fa-wrench"></i> Skills</a></li>
									<li><a href="/projects/"><i class="fas fa-fw fa-puzzle-piece"></i> Projects</a></li>
									<li><a href="https://notes.ibug.io/"><i class="fas fa-fw fa-sticky-note"></i> Notes</a></li>
									<li><a href="/friends/"><i class="fas fa-fw fa-user-friends"></i> Friends</a></li>
									<li><a href="/cn/"><i class="fas fa-fw fa-yin-yang"></i> Chinese Content</a></li>
								</ul>
							</li>
						</ul>
					</nav>
				</div>
				<article class="page" itemscope itemtype="https://schema.org/CreativeWork">
					<meta itemprop="headline" content="Raspberry Pi 4 B Review and Benchmark - What’s improved over Pi 3 B+">
					<meta itemprop="description" content="Lately I’ve finally received my Raspberry Pi 4 (4 GB model), and I couldn’t resist the temptation to give it a try and see all the improvements that’s been reported for months.">
					<meta itemprop="datePublished" content="2019-09-10T00:00:00+00:00">
					<meta itemprop="dateModified" content="2021-02-04T21:47:35+00:00">
					<div class="page__inner-wrap">
						<section class="page__content" itemprop="text">
							<aside class="sidebar__right sticky">
								<nav class="toc">
									<header>
										<h4 class="nav__title"><i class="fas fa-file-alt fa-fw"></i> On this page</h4>
									</header>
									<ul class="toc__menu">
										<li><a href="#overview">Overview</a></li>
										<li><a href="#specs">Specs</a></li>
										<li><a href="#setup">My setup</a></li>
										<li><a href="#benchmarking">Benchmarking</a>
											<ul>
												<li><a href="#cpu">1. SysBench CPU test</a></li>
												<li><a href="#2-sysbench-memory-test">2. SysBench memory test</a></li>
												<li><a href="#3-fio-microsd-card-speed-test">3. FIO microSD card speed test</a></li>
												<li><a href="#4-p7zip-benchmark">4. p7zip benchmark</a></li>
												<li><a href="#5-openssl-speed-test">5. OpenSSL speed test</a></li>
												<li><a href="#6-network-speed-test">6. Network speed test</a>
													<ul>
														<li><a href="#61-curl-file-download-test">6.1 cURL file download test</a></li>
														<li><a href="#62-nginx-performance-test">6.2 NGINX performance test</a></li>
													</ul>
												</li>
												<li><a href="#7-application-performance">7. Application performance</a></li>
												<li><a href="#8-usb-io-performance">8. USB I/O performance</a></li>
											</ul>
										</li>
										<li><a href="#bottom-line">Bottom line</a></li>
									</ul>
								</nav>
							</aside>
							<p>Lately I’ve finally received my Raspberry Pi 4 (4 GB model), and I couldn’t resist the temptation to give it a try and see all the improvements that’s been reported for months.</p>
							<p>As I’ve got one with my Pi 3 B+, I also ordered an aluminum “case” that can ease the ache of heating. One major difference is that the new cooling case is armed with two little fans, which is a rather huge boost in speed of heat dissipation.</p>
							<p>So let’s take a look at the new Pi 4.</p>
							<h2 id="overview">Overview</h2>
							<figure class="third ">
								<a href="/image/rpi4/box.jpg" title="Package of Raspberry Pi 4">
									<img src="/image/rpi4/box.jpg" alt="Package of Raspberry Pi 4" />
								</a>
								<a href="/image/rpi4/box-bottom.jpg" title="Bottom of the package">
									<img src="/image/rpi4/box-bottom.jpg" alt="Bottom of the package" />
								</a>
								<a href="/image/rpi4/box-open.jpg" title="Opening the package">
									<img src="/image/rpi4/box-open.jpg" alt="The package is open" />
								</a>
							</figure>
							<p>The new Pi 4 is wrapped in a box similar to that of Pi 3 B+, with a white outline of the Pi 4 in 1:1 scale on a red background. Unlike Pi 3 B, neither 3 B+ and 4 has a electrostatic-proof bag around them in the box. This isn’t anything of a problem, though.</p>
							<p>The new Pi 4 has a similar form factor as its predecessors, with a few noticeable differences, among which the USB 3.0 ports is the first to spot, as they’re marked blue. As you inspect the USB 3.0 ports, you probably have noticed that the Ethernet port changed its position as well, which is likely due to the upgrade to a true gigabit port.</p>
							<figure class="third ">
								<a href="/image/rpi4/overview.jpg" title="Overview of Raspberry Pi 4">
									<img src="/image/rpi4/overview.jpg" alt="Overview of Raspberry Pi 4" />
								</a>
								<a href="/image/rpi4/overview-usb.jpg" title="The USB ports and the Ethernet port">
									<img src="/image/rpi4/overview-usb.jpg" alt="Raspberry Pi 4 on top of the box, showing the USB ports and the Ethernet port" />
								</a>
								<a href="/image/rpi4/overview-side-ports.jpg" title="The USB Type-C port and the HDMI ports">
									<img src="/image/rpi4/overview-side-ports.jpg" alt="Focusing on the USB Type-C port and the HDMI ports" />
								</a>
							</figure>
							<p>Some smaller ports, namely the power supply and the video output, have changed as well. The Pi 4 now requires a Type-C cable for power, and the requirement has raised to 5V / 3A. It’s unknown whether the Pi 4 accepts advanced charging protocols like Qualcomm Quick Charge or USB PD, but user reports goes against such assumptions. The standard-size HDMI on older models has also been replaced by micro-HDMI port, pardon, <em>ports</em>. Yes, there are two, and both of them supports 4K @ 60 fps output, at the same time. While I’m planning to use this Pi as a headless server, people who use it as a desktop may find it favorable.</p>
							<p>The RAM chip has also been moved from the back of the board to the front, alongside the SoC, which has an identical look as that on Pi 3 B+, but with a completely different heart under the skins. The Wi-Fi case and antenna remain unchanged, and there’s an extra chip in front of the gigabit ethernet port.</p>
							<h2 id="specs">Specs</h2>
							<p>It’s an exciting news that the new Pi 4 brings a wire range of solid and concrete upgrades, namely</p>
							<ul>
								<li>Broadcom BCM2711 SoC, quad-core Cortex-A72 CPU @ 1.5 GHz</li>
								<li>Comes in variations of 1 GB, 2 GB and <strong>4 GB RAM</strong> (reviewed)</li>
								<li>Broadcom VideoCore VI GPU</li>
								<li>True Gigabit ethernet port</li>
								<li>Bluetooth 5.0</li>
								<li>Native USB 3.0 interface, with two Type-A ports</li>
								<li>Dual HDMI port, supporting 4K @ 60 fps simultaneously</li>
								<li>Faster microSD card slot</li>
							</ul>
							<p>In later benchmarks, you’ll see what these upgrades really mean. Here’s a table for comparison:</p>
							<table>
								<thead>
									<tr>
										<th>Item</th>
										<th style="text-align: center">Pi 3 B</th>
										<th style="text-align: center">Pi 3 B+</th>
										<th style="text-align: center">Pi 4</th>
									</tr>
								</thead>
								<tbody>
									<tr>
										<td>CPU</td>
										<td style="text-align: center">Quad-core<br />
											Cortex-A53 @ 1.20 GHz</td>
										<td style="text-align: center">Quad-core<br />
											Cortex-A53 @ 1.40 GHz</td>
										<td style="text-align: center">Quad-core<br />
											Cortex-A72 @ 1.50 GHz</td>
									</tr>
									<tr>
										<td>RAM</td>
										<td style="text-align: center">1 GB DDR2</td>
										<td style="text-align: center">1 GB DDR2</td>
										<td style="text-align: center">1 / 2 / <strong>4</strong> GB DDR4</td>
									</tr>
									<tr>
										<td>GPU</td>
										<td style="text-align: center">VideoCore IV</td>
										<td style="text-align: center">VideoCore IV</td>
										<td style="text-align: center">VideoCore VI</td>
									</tr>
									<tr>
										<td>Ethernet</td>
										<td style="text-align: center">100 Mbps</td>
										<td style="text-align: center">300 Mbps effective</td>
										<td style="text-align: center">1 Gbps</td>
									</tr>
									<tr>
										<td>Wi-Fi</td>
										<td style="text-align: center">2.4 GHz</td>
										<td style="text-align: center">2.4 GHz / 5 GHz</td>
										<td style="text-align: center">2.4 GHz / 5 GHz</td>
									</tr>
									<tr>
										<td>Bluetooth</td>
										<td style="text-align: center">4.0</td>
										<td style="text-align: center">4.2</td>
										<td style="text-align: center">5.0</td>
									</tr>
									<tr>
										<td>USB</td>
										<td style="text-align: center">4 * USB 2.0</td>
										<td style="text-align: center">4 * USB 2.0</td>
										<td style="text-align: center">2 * USB 2.0 + 2 * USB 3.0</td>
									</tr>
									<tr>
										<td>Price</td>
										<td style="text-align: center">$35</td>
										<td style="text-align: center">$35</td>
										<td style="text-align: center">$35 / $45 / <strong>$55</strong><br />
											Depending on RAM</td>
									</tr>
								</tbody>
							</table>
							<p>My Pi 3 B was sold soon after I got a 3 B+, so unfortunately there isn’t one participating this review.</p>
							<h2 id="setup">My setup</h2>
							<figure class=" ">
								<a href="/image/rpi4/rpis-powered.jpg" title="Both Raspberry Pis, powered through their GPIO pins">
									<img src="/image/rpi4/rpis-powered.jpg" alt="Both Raspberry Pis, powered through their GPIO pins" />
								</a>
							</figure>
							<p>As seen above, both Pis are set up as headless servers, with only power and ethernet connected. You’re probably wondering why they look so strange, which is because my laboratory provides a lot of these power supplies rated 5V / 6A, so I just took one and use it to power both Pis through GPIO. The two Pis are rated 5V / 2.5A and 5V / 3A each (peak), which this single power supply should be able to handle without difficulty.</p>
							<blockquote>
								<p><strong>WARNING</strong>: Do NOT power your Raspberry Pi through GPIO unless you have stable power supply. Phone chargers aren’t <em>power supplies</em> and should not be used to provide power in this way.</p>
							</blockquote>
							<h2 id="benchmarking">Benchmarking</h2>
							<p>The Pis have static IP assigned and all operation is done over SSH. Operating system is latest Raspbian Buster Lite.</p>
							<h3 id="cpu">1. SysBench CPU test</h3>
							<p>SysBench is a benchmark suite that allows you to quickly get an impression of system performance. Here I use SysBench for CPU and Memory tests.</p>
							<div class="language-shell highlighter-rouge">
								<div class="highlight">
									<pre class="highlight"><code>sysbench <span class="nt">--test</span><span class="o">=</span>cpu run
sysbench <span class="nt">--test</span><span class="o">=</span>cpu <span class="nt">--num-threads</span><span class="o">=</span>4 run
sysbench <span class="nt">--test</span><span class="o">=</span>cpu <span class="nt">--num-threads</span><span class="o">=</span>8 run
</code></pre>
								</div>
							</div>
							<p><img src="/image/rpi4/chart/sysbench-cpu.png" alt="SysBench CPU test result chart" class="block" /></p>
							<p>As shown in the chart, the Pi 4 has a decent improvement over Pi 3 B+ in terms of CPU performance, taking 19.3% less time to complete the SysBench test in all scenarios.</p>
							<h3 id="2-sysbench-memory-test">2. SysBench memory test</h3>
							<p>The memory test is a little bit complicated, and some unexpected results uncovers.</p>
							<div class="language-shell highlighter-rouge">
								<div class="highlight">
									<pre class="highlight"><code>sysbench <span class="nt">--test</span><span class="o">=</span>memory <span class="nt">--memory-block-size</span><span class="o">=</span>1K <span class="nt">--memory-total-size</span><span class="o">=</span>2G <span class="nt">--memory-oper</span><span class="o">=</span><span class="nb">read </span>run
sysbench <span class="nt">--test</span><span class="o">=</span>memory <span class="nt">--memory-block-size</span><span class="o">=</span>1K <span class="nt">--memory-total-size</span><span class="o">=</span>2G <span class="nt">--memory-oper</span><span class="o">=</span>write run
sysbench <span class="nt">--test</span><span class="o">=</span>memory <span class="nt">--memory-block-size</span><span class="o">=</span>1K <span class="nt">--memory-total-size</span><span class="o">=</span>2G <span class="nt">--memory-oper</span><span class="o">=</span><span class="nb">read</span> <span class="nt">--num-threads</span><span class="o">=</span>4 run
sysbench <span class="nt">--test</span><span class="o">=</span>memory <span class="nt">--memory-block-size</span><span class="o">=</span>1K <span class="nt">--memory-total-size</span><span class="o">=</span>2G <span class="nt">--memory-oper</span><span class="o">=</span>write <span class="nt">--num-threads</span><span class="o">=</span>4 run
sysbench <span class="nt">--test</span><span class="o">=</span>memory <span class="nt">--memory-block-size</span><span class="o">=</span>1M <span class="nt">--memory-total-size</span><span class="o">=</span>2G <span class="nt">--memory-oper</span><span class="o">=</span>write <span class="nt">--num-threads</span><span class="o">=</span>4 run
</code></pre>
								</div>
							</div>
							<p><img src="/image/rpi4/chart/sysbench-memory.png" alt="SysBench memory test result chart" class="block" /></p>
							<p>It’s very surprising to see the new DDR4 performs worse than the decades-old DDR2 memory, and even astonishing to see that multithreading makes the gap bigger. The only thing reasonable to me is that when a single block goes to 1 MiB, the Pi 4 outperforms the Pi 3 B+ slightly.</p>
							<p>There’s one interesting thing, though, that why I didn’t include a “1 MiB Read MT” column. SysBench reported a read speed of over 200 GB/s on both boards, and the results can sometimes go up to 500 GB/s, which is ridiculous to be taken seriously, so I just dropped that result.</p>
							<h3 id="3-fio-microsd-card-speed-test">3. FIO microSD card speed test</h3>
							<p>This test may depend on the microSD card, so I took out my (known) fastest cards for the Pis, the Lexar 667x 128 GB microSD card, which looks like below:</p>
							<center>
								<img src="/image/rpi4/microsd-card.jpg" alt="The microSD card" width="30%" />
							</center>
							<p>I use <code class="language-plaintext highlighter-rouge">fio</code> for the disk (microSD card) I/O performance testing tool. Because I’m familiar with Crystal DiskMark, I tuned the command-line options of <code class="language-plaintext highlighter-rouge">fio</code> to match the specs of CDM.</p>
							<div class="language-shell highlighter-rouge">
								<div class="highlight">
									<pre class="highlight"><code>fio <span class="nt">--loops</span><span class="o">=</span>5 <span class="nt">--size</span><span class="o">=</span>500m <span class="nt">--filename</span><span class="o">=</span>fiotest.tmp <span class="nt">--stonewall</span> <span class="nt">--ioengine</span><span class="o">=</span>libaio <span class="nt">--direct</span><span class="o">=</span>1 <span class="se">\</span>
  <span class="nt">--name</span><span class="o">=</span>SeqRead <span class="nt">--bs</span><span class="o">=</span>1m <span class="nt">--rw</span><span class="o">=</span><span class="nb">read</span> <span class="se">\</span>
  <span class="nt">--name</span><span class="o">=</span>SeqWrite <span class="nt">--bs</span><span class="o">=</span>1m <span class="nt">--rw</span><span class="o">=</span>write <span class="se">\</span>
  <span class="nt">--name</span><span class="o">=</span>512Kread <span class="nt">--bs</span><span class="o">=</span>512k <span class="nt">--rw</span><span class="o">=</span>randread <span class="se">\</span>
  <span class="nt">--name</span><span class="o">=</span>512Kwrite <span class="nt">--bs</span><span class="o">=</span>512k <span class="nt">--rw</span><span class="o">=</span>randwrite <span class="se">\</span>
  <span class="nt">--name</span><span class="o">=</span>4KQD32read <span class="nt">--bs</span><span class="o">=</span>4k <span class="nt">--iodepth</span><span class="o">=</span>32 <span class="nt">--rw</span><span class="o">=</span>randread <span class="se">\</span>
  <span class="nt">--name</span><span class="o">=</span>4KQD32write <span class="nt">--bs</span><span class="o">=</span>4k <span class="nt">--iodepth</span><span class="o">=</span>32 <span class="nt">--rw</span><span class="o">=</span>randwrite <span class="se">\</span>
  <span class="nt">--name</span><span class="o">=</span>4Kread <span class="nt">--bs</span><span class="o">=</span>4k <span class="nt">--rw</span><span class="o">=</span>randread <span class="se">\</span>
  <span class="nt">--name</span><span class="o">=</span>4Kwrite <span class="nt">--bs</span><span class="o">=</span>4k <span class="nt">--rw</span><span class="o">=</span>randwrite
</code></pre>
								</div>
							</div>
							<p><img src="/image/rpi4/chart/fio-microsd.png" alt="FIO microSD test result chart" class="block" /></p>
							<p>From the results we can see a huge boost on Pi 4, running 50% faster than its predecessor in many tests. This is probably the most useful upgrades on Pi 4, as the performance has always been constrained by the slow disk I/O.</p>
							<h3 id="4-p7zip-benchmark">4. p7zip benchmark</h3>
							<p>7-Zip has a built-in benchmarking tool, and so does its POSIX port <code class="language-plaintext highlighter-rouge">p7zip</code>. I use this tool to test the compression and decompression performance on the Pis.</p>
							<div class="language-shell highlighter-rouge">
								<div class="highlight">
									<pre class="highlight"><code>7zr b <span class="nt">-mmt1</span>
7zr b
</code></pre>
								</div>
							</div>
							<p><img src="/image/rpi4/chart/p7zip.png" alt="p7zip benchmark result chart" class="block" /></p>
							<p>As <a href="https://sevenzip.osdn.jp/chm/cmdline/commands/bench.htm">the help article</a> says, compression depends more on the throughput and latency of memory, which is likely the reason that the gap between the two Pis is bigger in compression test. After all, there’s a boost of 1/3 in the p7zip test.</p>
							<h3 id="5-openssl-speed-test">5. OpenSSL speed test</h3>
							<p>OpenSSL is the most prevalent crypto library, and it also has built-in speed test as well. The result is the fastest speed among all block sizes, which is always 16,384 bytes in all 4 tests.</p>
							<div class="language-shell highlighter-rouge">
								<div class="highlight">
									<pre class="highlight"><code>openssl speed <span class="nt">-evp</span> aes-256-cbc
openssl speed <span class="nt">-evp</span> aes-256-gcm
openssl speed <span class="nt">-evp</span> sha1
openssl speed <span class="nt">-evp</span> sha256
</code></pre>
								</div>
							</div>
							<p><img src="/image/rpi4/chart/openssl.png" alt="OpenSSL speed result chart" class="block" /></p>
							<h3 id="6-network-speed-test">6. Network speed test</h3>
							<p>The Pi 4 upgraded the 300 Mbps Ethernet port to a true 1 Gbps port, which is a great benefit if you want to use it as an offline downloader or an NAS. Here I ran two tests about the network connectivity.</p>
							<h4 id="61-curl-file-download-test">6.1 cURL file download test</h4>
							<p>This one is simple: Use cURL to download a file from a LAN machine and see the speed.</p>
							<p><img src="/image/rpi4/chart/cURL.png" alt="cURL download speed chart" class="block" /></p>
							<p>The result isn’t as expected: The Pi 4 failed to run at its true Gbps speed, while my x86 Linux box right beside it made it.</p>
							<h4 id="62-nginx-performance-test">6.2 NGINX performance test</h4>
							<p>Another common use case is to serve web content with NGINX (sorry, no Apache). I installed NGINX on both Pis, set <code class="language-plaintext highlighter-rouge">access_log off</code> and use Siege 4.0.4 on my x86 box to benchmark the servers.</p>
							<div class="language-shell highlighter-rouge">
								<div class="highlight">
									<pre class="highlight"><code>siege <span class="nt">-c</span> 10 <span class="nt">-r</span> 1000 <span class="o">[</span>host]
siege <span class="nt">-c</span> 25 <span class="nt">-r</span> 400 <span class="o">[</span>host]
</code></pre>
								</div>
							</div>
							<p><img src="/image/rpi4/chart/nginx.png" alt="Siege NGINX result chart" class="block" /></p>
							<p>With the increase in both CPU performance and network speed, the new Pi 4 runs almost twice as efficient as the Pi 3 B+. Surely a good news for the websiters.</p>
							<h3 id="7-application-performance">7. Application performance</h3>
							<p>I picked two of my favorite platforms, Python and Ruby (I’m not familiar with Node) for this test.</p>
							<p>The Python test involves a stupid script taken from <a href="">this Stack Overflow answer</a>, and the time is taken as the result.</p>
							<div class="language-python highlighter-rouge">
								<div class="highlight">
									<pre class="highlight"><code><span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
    <span class="s">"""Stupid test function"""</span>
    <span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">timeit</span>
    <span class="k">print</span><span class="p">(</span><span class="n">timeit</span><span class="p">.</span><span class="n">timeit</span><span class="p">(</span><span class="s">"test()"</span><span class="p">,</span> <span class="n">setup</span><span class="o">=</span><span class="s">"from __main__ import test"</span><span class="p">))</span>
</code></pre>
								</div>
							</div>
							<p>The Ruby test is simpler: Using Jekyll to build this site and see the time taken.</p>
							<p><img src="/image/rpi4/chart/python-ruby.png" alt="Application test result chart" class="block" /></p>
							<p>The Ruby test is more balanced than the Python test, which is pure computational performance. As a result, the performance gap is smaller in the Ruby test.</p>
							<p>Wait, that doesn’t mean the Pi 4 would be a good platform for your bigger Python or Ruby project. The same tests run <strong>10x faster</strong> on my x86 Linux box (i7-8850H, 32 GB DDR4, NVMe SSD), running the Python script in 5 seconds and building my Jekyll site in 4 seconds. Well, you can’t expect a beefy computer from only a board costing $55, n’est-ce pas?</p>
							<h3 id="8-usb-io-performance">8. USB I/O performance</h3>
							<p>I took out my USB 3.1 SSD (assembled with a LiteOn L9M 512 GB and an enclosure case with VL716 SATA-to-USB adapter chip). However, as soon as I plug the SSD into either Pi, it powers down immediately. This later turns out to be the issue with power supply (GPIO pins can’t pass enough power), so I came back the day after and started the Pis with power supply from the Micro USB / Type-C port. This time the Pi 3 B+ works correctly and ran through the <code class="language-plaintext highlighter-rouge">fio</code> test. The Pi 4, however, drops the SSD during the test due to power supply, <em>again</em>. I ended up powering the Pi through <strong>both</strong> Type-C and GPIO only to allow it to run the test on the SSD without power failure.</p>
							<p>The power is a real issue this time, but putting it aside, let’s look at the results:</p>
							<div class="language-shell highlighter-rouge">
								<div class="highlight">
									<pre class="highlight"><code>fio <span class="nt">--loops</span><span class="o">=</span>5 <span class="nt">--size</span><span class="o">=</span>1g <span class="nt">--filename</span><span class="o">=</span>fiotest.tmp <span class="nt">--stonewall</span> <span class="nt">--ioengine</span><span class="o">=</span>libaio <span class="nt">--direct</span><span class="o">=</span>1 <span class="nt">--name</span><span class="o">=</span>SeqRead <span class="nt">--bs</span><span class="o">=</span>1m <span class="nt">--rw</span><span class="o">=</span><span class="nb">read</span> <span class="nt">--name</span><span class="o">=</span>SeqWrite <span class="nt">--bs</span><span class="o">=</span>1m <span class="nt">--rw</span><span class="o">=</span>write
</code></pre>
								</div>
							</div>
							<p><img src="/image/rpi4/chart/fio-usb.png" alt="FIO USB test result chart" class="block" /></p>
							<p>That’s impressive! The ever-upgraded USB 3.0 ports, even if not running at its top speed, is an exceptional lead over previous generations of Raspberry Pi. But before enjoying the turbo speed of the new USB ports, let’s emphasize again that you need to take special care for your USB peripherals, especially those requiring just a little bit more power than others, like hard drives and SSDs. Rest assured, if the power issue is properly taken care of, utilizing these two ultra-speed USB ports would be a great benefit to your Pi-based NAS setup or whatever storage extension.</p>
							<h2 id="bottom-line">Bottom line</h2>
							<p>Seen the marginal improvement from Raspberry Pi 3 B to 3 B+, the new Pi 4 is probably a banquet to most Pi enthusiasts. With the price remaining the same, the Pi 4 is a must-buy for everyone, even if you already have a Pi 3 B+. While there are downsides in power supply and cooling, they aren’t much of a deal if you don’t attach too many peripherals or put the Pi at constant high load.</p>
						</section>
						<footer class="page__meta">
							<p class="page__taxonomy">
								<strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
								<span itemprop="keywords">
									<a href="/tag/benchmark" class="page__taxonomy-item" rel="tag">benchmark</a><span class="sep">, </span>
									<a href="/tag/raspberry-pi" class="page__taxonomy-item" rel="tag">raspberry-pi</a>
								</span>
							</p>
							<p class="page__taxonomy">
								<strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
								<span itemprop="keywords">
									<a href="/category/reviews" class="page__taxonomy-item" rel="tag">reviews</a>
								</span>
							</p>
							<p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2021-02-04">February 4, 2021</time></p>
						</footer>
						<section class="page__share">
							<h4 class="page__share-title">Share on</h4>
							<a href="https://twitter.com/intent/tweet?text=Raspberry+Pi+4+B+Review+and+Benchmark+-+What%27s+improved+over+Pi+3+B%2B%20https%3A%2F%2Fibug.io%2Fblog%2F2019%2F09%2Fraspberry-pi-4-review-benchmark%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>
							<a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fibug.io%2Fblog%2F2019%2F09%2Fraspberry-pi-4-review-benchmark%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>
							<a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fibug.io%2Fblog%2F2019%2F09%2Fraspberry-pi-4-review-benchmark%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
						</section>
						<nav class="pagination">
							<a href="/blog/2019/08/speech-at-msc-2019/" class="pagination--pager" title="My speech at Microsoft Summer Camp 2019
">Previous</a>
							<a href="/blog/2019/09/convert-dfa-to-regex/" class="pagination--pager" title="Converting DFA to Regular Expression
">Next</a>
						</nav>
					</div>
					<div class="page__comments">
						<h4 class="page__comments-title">Leave a comment</h4>
						<section id="disqus_thread"></section>
					</div>
				</article>
				<div class="page__related">
					<h4 class="page__related-title">You may also enjoy</h4>
					<div class="grid__wrapper">
						<div class="grid__item">
							<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
								<h2 class="archive__item-title no_toc" itemprop="headline">
									<a href="/blog/2021/01/linux-container-explained/" rel="permalink">A Deep Dive into Containers
									</a>
								</h2>
								<p class="page__meta">
									<span class="page__meta-date">
										<i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
										<time datetime="2021-01-31T00:00:00+00:00">January 31, 2021</time>
									</span>
									<span class="page__meta-sep"></span>
									<span class="page__meta-readtime">
										<i class="far fa-fw fa-clock" aria-hidden="true"></i>
										20 minute read
									</span>
								</p>
								<p class="archive__item-excerpt" itemprop="description">Since years ago, containers have been a hot topic everywhere. There are many container softwares like Docker, Linux Containers and Singularity. It’s hard to say one understand what containers are without diving into all the gory details of them, so I decided to go on this exploration myself.
								</p>
							</article>
						</div>
						<div class="grid__item">
							<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
								<h2 class="archive__item-title no_toc" itemprop="headline">
									<a href="/blog/2019/12/mass-crawl-douban-with-aws/" rel="permalink">High-performance mass web crawling on AWS
									</a>
								</h2>
								<p class="page__meta">
									<span class="page__meta-date">
										<i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
										<time datetime="2019-12-28T00:00:00+00:00">December 28, 2019</time>
									</span>
									<span class="page__meta-sep"></span>
									<span class="page__meta-readtime">
										<i class="far fa-fw fa-clock" aria-hidden="true"></i>
										16 minute read
									</span>
								</p>
								<p class="archive__item-excerpt" itemprop="description">The 3rd-and-last experiment of course Web Information Processing and Application required us to create a recommendation engine, and “predict” the rating (1-5 stars) for 4M user-item pairs based on the training data of 9M user-item pairs and a social network.
								</p>
							</article>
						</div>
						<div class="grid__item">
							<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
								<h2 class="archive__item-title no_toc" itemprop="headline">
									<a href="/blog/2019/08/speech-at-msc-2019/" rel="permalink">My speech at Microsoft Summer Camp 2019
									</a>
								</h2>
								<p class="page__meta">
									<span class="page__meta-date">
										<i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
										<time datetime="2019-08-14T00:00:00+00:00">August 14, 2019</time>
									</span>
									<span class="page__meta-sep"></span>
									<span class="page__meta-readtime">
										<i class="far fa-fw fa-clock" aria-hidden="true"></i>
										10 minute read
									</span>
								</p>
								<p class="archive__item-excerpt" itemprop="description">This is a translated version from the Chinese (original) script. The slideshow can be acquired here. For comments, please head to the Chinese version of this post.
								</p>
							</article>
						</div>
						<div class="grid__item">
							<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
								<h2 class="archive__item-title no_toc" itemprop="headline">
									<a href="/blog/2019/12/manage-servers-with-ssh-ca/" rel="permalink">Managing servers with OpenSSH Certificate Authority
									</a>
								</h2>
								<p class="page__meta">
									<span class="page__meta-date">
										<i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
										<time datetime="2019-12-23T00:00:00+00:00">December 23, 2019</time>
									</span>
									<span class="page__meta-sep"></span>
									<span class="page__meta-readtime">
										<i class="far fa-fw fa-clock" aria-hidden="true"></i>
										6 minute read
									</span>
								</p>
								<p class="archive__item-excerpt" itemprop="description">Since the addition of the website server for an external corporation, I now have 5 Linux servers to manage on my own. I also have 4 terminal devices that I use to connect to those servers: two of my laptops, my Android phone (using Termux), and one of those servers that I use as a workstation.
								</p>
							</article>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="search-content">
			<div class="search-content__inner-wrap">
				<div class="search-searchbar"></div>
				<div class="search-hits"></div>
			</div>
		</div>
		<div id="footer" class="page__footer">
			<footer>
				<!-- start custom footer snippets -->
				<!-- end custom footer snippets -->
				<div class="page__footer-follow">
					<ul class="social-icons">
						<li><strong>Follow:</strong></li>
						<li><a href="https://github.com/iBug" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
						<li><a href="https://stackoverflow.com/users/5958455/ibug" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-stack-overflow" aria-hidden="true"></i> Stack Overflow</a></li>
						<li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
					</ul>
				</div>
				<div class="page__footer-copyright">
					<p>&copy; 2021 iBug. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</p>
					<p>Except otherwise noted, content on this site is licensed under the <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0 License</a>. Attribution required.</p>
					<p><a href="/privacy-policy">Privacy Policy</a> | <a href="/sitemap.xml">Sitemap (XML)</a></p>
					<p>
						Site version <a href="/status" class="version-text">G-482</a>
					</p>
				</div>
			</footer>
		</div>
		<script src="/assets/js/main.min.js?v=3"></script>
		<!-- Including InstantSearch.js library and styling -->
		<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3.3/dist/instantsearch.min.js"></script>
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3.3/dist/instantsearch.min.css">
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3.3/dist/instantsearch-theme-algolia.min.css">
		<script>
			// Instanciating InstantSearch.js with Algolia credentials
			const search = instantsearch({
			  appId: '14DZKASAEJ',
			  apiKey: 'a0d8cb9da2d6ad0d17dcd40c58c72a56',
			  indexName: 'iBug_website',
			  searchParameters: {
			    restrictSearchableAttributes: [
			      'title',
			      'content'
			    ]
			  }
			});
			
			const hitTemplate = function(hit) {
			  const url = hit.url;
			  const title = hit._highlightResult.title.value;
			  const content = hit._highlightResult.html.value;
			
			  return `
			    <div class="list__item">
			      <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
			        <h2 class="archive__item-title" itemprop="headline"><a href="${url}">${title}</a></h2>
			        <div class="archive__item-excerpt" itemprop="description">${content}</div>
			      </article>
			    </div>
			  `;
			}
			
			// Adding searchbar and results widgets
			search.addWidget(
			  instantsearch.widgets.searchBox({
			    container: '.search-searchbar',
			    poweredBy: true,
			    placeholder: 'Enter your search term...'
			  })
			);
			search.addWidget(
			  instantsearch.widgets.hits({
			    container: '.search-hits',
			    templates: {
			      item: hitTemplate,
			      empty: 'No results',
			    }
			  })
			);
			
			// Starting the search only when toggle is clicked
			$(document).ready(function () {
			  $(".search__toggle").on("click", function() {
			    if(!search.started) {
			      search.start();
			    }
			  });
			});
		</script>
		<script>
			var _gaq = _gaq || [];
			_gaq.push(['_setAccount', 'UA-115907213-1']);
			
			_gaq.push(['_trackPageview']);
			
			(function() {
			  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
			})();
		</script>
		<script>
			var disqus_config = function () {
			  this.page.url = "https://ibug.io/blog/2019/09/raspberry-pi-4-review-benchmark/";  /* Replace PAGE_URL with your page's canonical URL variable */
			  this.page.identifier = "/blog/2019/09/raspberry-pi-4-review-benchmark"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */
			};
			(function() { /* DON'T EDIT BELOW THIS LINE */
			  var d = document, s = d.createElement('script');
			  s.src = 'https://ibugone.disqus.com/embed.js';
			  s.setAttribute('data-timestamp', +new Date());
			  (d.head || d.body).appendChild(s);
			})();
		</script>
		<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
	</body>
</html>